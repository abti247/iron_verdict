# JudgeMe - Requirements Specification

## Document Information

- **Version:** 1.0
- **Last Updated:** 2026-01-14
- **Status:** Draft for Review

---

# 1. FUNCTIONAL REQUIREMENTS

## 1.1 Session Management

**FR1:** System shall generate cryptographically secure session IDs using minimum 128-bit entropy
- **Rationale:** Prevent brute-force attacks on session URLs
- **Implementation:** Use Node.js `crypto.randomBytes(16)` or UUID v4
- **Priority:** High

**FR2:** System shall create unique URLs for each role in a competition:
- Admin control panel URL
- Competition Manager URL (pre-competition athlete setup)
- Athlete Manager URL (live weight updates during competition)
- Platform Loader URL (plate loading calculator)
- Judge URL (shared by all 3 judges with position selection)
- Venue Audience display URL (vote lights)
- Competition Host URL (announcer)
- **Rationale:** Role-based access without authentication
- **Priority:** High
- **Total:** 7 URLs per competition (reduced from 8 by consolidating judge URLs)

**FR3:** Session URLs shall not be guessable or brute-forceable
- **Rationale:** Security through unguessable tokens
- **Verification:** Tokens must have ≥ 2^128 possible values
- **Priority:** High

**FR4:** System shall persist sessions to database (SQLite)
- **Rationale:** Survive server restarts, enable historical dashboard
- **Priority:** High

**FR5:** System shall allow admin to manually end/close session
- **Rationale:** Mark competition as complete, trigger archival
- **Priority:** Medium

**FR6:** System shall support only ONE platform per competition (MVP scope)
- **Rationale:** Simplify MVP, focus on core functionality
- **Priority:** High
- **Note:** Multi-platform support deferred to v2.0

---

## 1.2 Competition Setup

**FR7:** Admin shall create competition with required fields:
- Competition name (text, required, max 200 characters)
- Competition date (optional)
- **Rationale:** Admin focuses on high-level setup; Competition Manager handles athlete data
- **Priority:** High
- **Note:** Athletes are entered separately by Competition Manager (see FR7a)

**FR7a:** Competition Manager shall enter athlete data before competition:
- Athlete name (required)
- Weigh-in weight (required, numeric)
- Opening squat attempt weight (required, numeric)
- Opening bench attempt weight (required, numeric)
- Opening deadlift attempt weight (required, numeric)
- **Rationale:** Separates pre-competition data entry from admin oversight
- **Priority:** High

**FR7b:** Competition Manager shall create groups and flights:
- Groups contain multiple flights (sub-groups)
- Flights contain athletes (typical size: 8-15 athletes)
- Flights can be created manually or auto-generated by weight class
- Athletes can be assigned to flights via drag-and-drop interface
- **Rationale:** Organizes competition structure before starting
- **Priority:** High

**FR7c:** System shall support bulk athlete import via CSV:
- CSV format: name, weigh-in weight, squat attempt, bench attempt, deadlift attempt
- System validates all rows before importing
- Invalid rows are flagged with error messages
- **Rationale:** Speeds up data entry for large competitions
- **Priority:** Medium

**FR8:** System shall automatically generate 9 lift attempts per athlete
- 3 SQUAT attempts (attempt 1, 2, 3)
- 3 BENCH attempts (attempt 1, 2, 3)
- 3 DEADLIFT attempts (attempt 1, 2, 3)
- **Rationale:** Standard powerlifting format (3 lifts × 3 attempts)
- **Priority:** High

**FR9:** System shall assign lot numbers to athletes automatically
- **Behavior:** Sequential numbering starting from 1
- **Option:** Allow admin to manually reorder (nice-to-have)
- **Rationale:** Determines lifting order
- **Priority:** High

**FR10:** System shall validate competition creation inputs:
- Minimum 1 athlete required
- Maximum 100 athletes per competition
- Competition name cannot be empty
- Athlete names cannot be empty
- **Priority:** High

---

## 1.3 Judging & Voting

### 1.3.1 Judge Position Selection

**FR10a:** System shall display position selection screen when judge opens shared judge URL
- **UI:** Three large buttons labeled [LEFT] [CENTER] [RIGHT]
- **Size:** Minimum 100px height for clear touch targets
- **State:** Buttons for taken positions are disabled/greyed out
- **Priority:** High

**FR10b:** System shall implement server-side position locking with database transactions
- **Mechanism:** First-come, first-served using database transaction isolation
- **Table:** `judge_positions` with columns: competitionId, position, claimedAt, sessionId
- **Constraint:** UNIQUE constraint on (competitionId, position)
- **Conflict Handling:** If position already taken, return 409 error with message "Position already taken, please select another position"
- **Priority:** High

**FR10c:** System shall adapt judge UI based on selected position
- **CENTER Position UI:**
  - START CLOCK button
  - RESET CLOCK button
  - WHITE voting button
  - RED voting button
  - RELEASE POSITION button (disabled when timer running)
- **LEFT/RIGHT Position UI:**
  - WHITE voting button
  - RED voting button
  - Timer display (read-only)
  - RELEASE POSITION button (disabled when timer running)
- **Priority:** High

**FR10d:** System shall allow judges to release their position
- **Constraint:** RELEASE POSITION button disabled while timer is running
- **Behavior (ALL positions):** Can only release when timer is NOT running
- **CENTER-specific:** Must stop timer (via RESET or natural expiration) before releasing
- **After Release:** Position becomes available for re-selection, judge returns to position selection screen
- **Priority:** High

**FR10e:** RESET button behavior (CENTER position only)
- **Immediate Effect:** Stops timer countdown
- **Sets Timer:** 60 seconds (ready state)
- **Does NOT:** Auto-start timer (judge must press START to begin countdown)
- **Priority:** High

### 1.3.2 Voting and Lift Information

**FR11:** Each judge interface shall display current lift information:
- Athlete name
- Lift type (SQUAT, BENCH, or DEADLIFT)
- Attempt number (1, 2, or 3)
- Weight (optional field, may be null)
- **Priority:** High

**FR12:** Judge interface shall display WHITE and RED voting buttons
- **Size:** Minimum 80px height for mobile touch targets
- **Color:** WHITE button = green, RED button = red
- **Accessibility:** WCAG 2.1 compliant contrast ratios
- **Priority:** High

**FR13:** System shall accept exactly one vote per judge per lift initially
- **Enforcement:** Database unique constraint on (liftId, judgePosition)
- **Priority:** High

**FR14:** System shall allow judges to change their vote before all 3 judges have voted
- **Behavior:** Judges can change vote via PUT /api/votes/:voteId endpoint
- **UI:** After voting, show "Change Vote" button and keep opposite vote button enabled
- **Confirmation:** System asks judge to confirm vote change
- **Restriction:** Once all 3 judges vote, votes are locked (no changes allowed)
- **Rationale:** Prevents fat-finger errors while maintaining result integrity
- **Priority:** High

**FR14a:** System shall prevent vote changes after all 3 judges have voted
- **Behavior:** Return 403 error if judge attempts to change vote after result calculated
- **UI:** Disable vote buttons after `lift_completed` event emitted
- **Rationale:** Results are final once all judges vote
- **Priority:** High

**FR15:** Vote record shall include:
- Judge position (LEFT, CENTER, or RIGHT)
- Decision (WHITE or RED)
- Timestamp (auto-generated on insert)
- Foreign key to lift
- **Priority:** High

**FR16:** System shall calculate lift result when all 3 votes received:
- **GOOD_LIFT:** 2 or 3 WHITE lights
- **NO_LIFT:** 2 or 3 RED lights
- **Auto-trigger:** Calculation runs immediately when vote count = 3
- **Priority:** High

**FR17:** System shall broadcast vote updates in real-time with suspense management
- **Technology:** Socket.IO events
- **Internal Events:** `vote_submitted` event emitted when each judge votes (internal, not shown to venue audience)
- **Public Events:** `lift_completed` event emitted ONLY after all 3 judges vote (includes all votes and result)
- **Venue Display Behavior:** All 3 vote lights appear SIMULTANEOUSLY when `lift_completed` event received
- **Rationale:** Maintains suspense - audience doesn't see partial votes
- **Latency target:** < 200ms from 3rd vote submission to simultaneous vote reveal
- **Priority:** High

---

## 1.4 Admin Control Panel

**FR18:** Admin dashboard shall display group/flight selector
- **Dropdown 1:** Select group (e.g., "Men's Open", "Women's Open")
- **Dropdown 2:** Select flight within group (e.g., "Flight A", "Flight B")
- **Dropdown 3:** Select discipline (SQUAT, BENCH, or DEADLIFT)
- **Button:** Large "START COMPETITION" button
- **Priority:** High

**FR18a:** Admin dashboard shall display active flight progress
- **Display:** Current flight name and discipline (e.g., "Men's Open - Flight A - SQUAT")
- **Progress:** "5 of 30 lifts completed" counter
- **Lift Queue:** Ordered list of upcoming lifts in current flight
- **Priority:** High

**FR19:** Admin shall start competition flow by selecting group/flight and discipline
- **Behavior:** Click "START COMPETITION" → System emits `flight_started` event
- **Auto-activation:** System automatically activates first lift in flight
- **Constraint:** Only one flight can be active at a time
- **Priority:** High

**FR20:** Admin shall see real-time voting status for current lift
- **Display:** 3 indicators (LEFT, CENTER, RIGHT)
- **States:** Empty (no vote), ✓ White (voted white), ✓ Red (voted red)
- **Priority:** High

**FR21:** Admin shall have ability to:
- **Reset current lift votes** if error occurs (delete all votes, keep lift IN_PROGRESS)
- **Skip lift** if athlete withdraws (mark status as SKIPPED)
- **End competition** (change status to ENDED, save timestamp)
- **Priority:** Medium

**FR22:** Admin dashboard shall display live leaderboard
- **Calculation:** Sum of best squat, best bench, best deadlift per athlete
- **Sorting:** Descending by total
- **Update trigger:** After each lift completes
- **Priority:** Low (nice-to-have for MVP)

---

## 1.4a Athlete Manager Interface

**FR22a:** Athlete Manager interface shall provide fast weight update functionality:
- **Display:** Current flight and discipline header
- **Search bar:** Large, auto-focused, searches by athlete name or lot number
- **Athlete list:** Shows all athletes in active flight with current attempt and last result
- **Weight input:** Large, prominent field for next attempt weight
- **Target:** Complete weight update in < 15 seconds per athlete
- **Priority:** High

**FR22b:** Athlete Manager shall update athlete next attempt weight during live competition:
- **API:** PUT /api/athletes/:athleteId/attempts/:attemptNumber/weight
- **Validation:** Weight must be ≥ previous successful attempt (if GOOD lift)
- **Socket.IO:** Emit `attempt_weight_updated` event to all connected clients
- **Update targets:** Judge displays, audience displays, announcer display
- **Priority:** High

**FR22c:** Athlete Manager interface shall provide real-time search and filtering:
- **Search input:** Types athlete name → instant filter results
- **Search by lot number:** Types number → find athlete
- **Auto-clear:** After successful weight update, clear search and return to full list
- **Keyboard shortcuts:** Enter key saves weight, ESC clears search
- **Priority:** High

**FR22d:** Athlete Manager interface shall handle flight transitions:
- **Behavior:** When admin starts new flight, Athlete Manager sees `flight_started` event
- **Display:** Notification "Flight changed to X" with auto-refresh
- **Auto-update:** Athlete list refreshes to show new flight's athletes
- **Priority:** Medium

---

## 1.4b Platform Loader Display

**FR22e:** Platform Loader display shall show plate loading calculator with visual breakdown:
- **Current Athlete Panel:**
  - Athlete name (very large font, readable from 10-15 feet)
  - Discipline, attempt number
  - **Total weight on bar** (HUGE font)
- **Plate Loading Calculator:**
  - Bar weight indicator (20kg men's / 15kg women's)
  - Weight per side calculation
  - **Visual plate diagram** with colored rectangles representing plates
  - Plate quantities: 25kg, 20kg, 15kg, 10kg, 5kg, 2.5kg, 1.25kg
  - Each plate color-coded to match real IPF plate colors
- **Next 2-3 Athletes "On Deck":**
  - Shows upcoming athletes with weight and plate requirements
  - Allows loaders to anticipate weight changes
- **Priority:** High

**FR22f:** System shall calculate plate loading using greedy algorithm:
- **Algorithm:** Calculate (Total Weight - Bar Weight) / 2 = Weight Per Side
- Use greedy approach: maximize largest plates first (25kg → 20kg → 15kg → 10kg → 5kg → 2.5kg → 1.25kg)
- Minimize total number of plates needed
- Display result as visual diagram with color-coded plates
- **Standard IPF Plates:**
  - 25kg: Red
  - 20kg: Blue
  - 15kg: Yellow
  - 10kg: Green
  - 5kg: White
  - 2.5kg: Black
  - 1.25kg: Chrome/Silver
- **Priority:** High

**FR22g:** Platform Loader display shall show weight change indicators:
- **Behavior:** When weight changes between lifts, calculate difference
- **Display:** Show "+10kg" or "-15kg" in large text
- **Highlight:** Show which plates to ADD (green) or REMOVE (red)
- **Example:** "REMOVE: 2.5kg × 1, ADD: 10kg × 1"
- **Large Weight Jumps:** Alert if change > 20kg ("LARGE WEIGHT CHANGE: +45kg")
- **Priority:** High

**FR22h:** Platform Loader display shall alert on bar weight changes:
- **Detection:** Detect switch between male (20kg bar) and female (15kg bar) athletes
- **Display:** Large alert: "BAR CHANGE: Switch to 15kg Women's Bar"
- **Recalculation:** Automatically recalculate all plate weights for new bar
- **Priority:** High

**FR22i:** Platform Loader display shall validate weight feasibility:
- **Validation:** Check if weight is achievable with standard plates
- **Granularity:** Minimum increment is 2.5kg (2 × 1.25kg plates)
- **Invalid weights:** Display warning "INVALID WEIGHT: Cannot load with standard plates"
- **Suggestion:** Show closest achievable weight
- **Priority:** Medium

**FR22j:** Platform Loader display shall update in real-time:
- **Socket.IO Events:**
  - `lift_completed` → advance to next athlete, show new plate loading
  - `attempt_weight_updated` → recalculate plates immediately for updated weight
  - `flight_started` → refresh display with new flight athletes
- **Update Speed:** < 200ms from event to display update
- **Priority:** High

---

## 1.5 Venue Audience Display (Vote Lights)

**FR23:** Venue audience display shall show current lift information:
- Current athlete name (very large font, readable from 30+ feet)
- Lift type icon and attempt number
- Weight (if specified)
- Timer display (countdown from 60 seconds)
- 3 judge indicators (LEFT, CENTER, RIGHT positions) as large circles
- Labels: "LEFT" "CENTER" "RIGHT" under circles
- **Optimization:** TV/projector display (1920×1080 or higher)
- **Priority:** High

**FR24:** Judge indicators shall maintain suspense and reveal simultaneously:
- **Initial state:** Neutral/grey circles
- **During voting:** Circles remain grey (individual votes NOT shown)
- **Critical:** System does NOT update circles when `vote_submitted` events received
- **After all 3 vote:** ALL THREE circles update SIMULTANEOUSLY on `lift_completed` event
- **WHITE vote:** Circle transitions to white/green
- **RED vote:** Circle transitions to red
- **Animation:** Smooth synchronized animation (0.3s duration, all at once)
- **Rationale:** Maintains suspense and dramatic reveal
- **Priority:** High

**FR25:** Display shall show final result prominently when lift complete
- **Display:** Large banner overlay
- **Text:** "GOOD LIFT" (green) or "NO LIFT" (red)
- **Duration:** Auto-hide after 3 seconds
- **Priority:** High

**FR26:** Display shall show competition header
- **Content:** Competition name, current flight, discipline
- **Update:** When flight changes
- **Priority:** Medium

---

## 1.5a Remote Audience Dashboard (Competition Progress)

**FR26a:** Remote audience dashboard shall provide simple, mobile-friendly interface:
- Competition name and current flight header
- **Up Next section:** Current athlete (highlighted) + next 2-3 athletes on deck
- **Current Standings / Leaderboard:** Athletes sorted by total, color-coded results
- **Recent Results feed:** Last 5 lifts with athlete, weight, result
- **Search bar:** Find specific athlete by name
- **Optimization:** Mobile devices (smartphones, tablets)
- **Priority:** Medium (nice-to-have for MVP)

**FR26b:** Remote dashboard shall NOT show individual vote lights:
- Focus on results and standings, not judging process
- Updates after `lift_completed` event only
- Shows "Lift in progress..." indicator during voting
- **Priority:** Medium

**FR26c:** Remote dashboard shall update in real-time:
- Standings recalculated after each lift
- "Up Next" queue updates automatically
- Recent results feed scrolls with new results
- **Latency:** < 1 second from lift completion to dashboard update
- **Priority:** Medium

---

## 1.5b Competition Host / Announcer Display

**FR26d:** Competition Host display shall provide announcer-optimized interface:
- **Current Athlete Panel:** Name (very large), discipline, attempt, weight, status
- **On Deck Section:** Next 2-3 athletes with name, attempt, weight
- **Timer display:** Head referee countdown (for timing cues)
- **Recent Results:** Collapsible section showing last 5-10 lifts
- **Optimization:** Tablet/laptop at announcer booth, readable from 6+ feet
- **Priority:** Low (nice-to-have)

**FR26e:** Competition Host display shall auto-update with lift events:
- Updates on `lift_started` event (new current athlete)
- Updates on `attempt_weight_updated` event (weight changes)
- Updates on `lift_completed` event (shows result briefly, then advances)
- Auto-scrolls "On Deck" queue
- **Priority:** Low

---

## 1.6 Historical Dashboard

**FR27:** System shall save completed competitions with statistics:
- Competition name
- Start timestamp (auto-captured on creation)
- End timestamp (captured when admin ends competition)
- Duration (calculated: endedAt - createdAt)
- Number of athletes (count of athlete records)
- Total lift attempts (count of all lifts)
- Successful lifts count (count where result = GOOD_LIFT)
- Failed lifts count (count where result = NO_LIFT)
- Per-judge statistics:
  - LEFT judge: white count, red count
  - CENTER judge: white count, red count
  - RIGHT judge: white count, red count
- **Priority:** Medium

**FR28:** Dashboard shall display list of past competitions
- **Sorting:** Date descending (newest first)
- **Columns:** Name, date, duration, athletes, lifts, success rate
- **Priority:** Medium

**FR29:** Dashboard shall show key statistics per competition
- **Metrics:** All fields from FR27
- **Priority:** Medium

**FR30:** Admin shall be able to view detailed results of past competitions
- **Details:** Lift-by-lift breakdown, athlete results, judge voting patterns
- **Priority:** Low (nice-to-have)

---

# 2. NON-FUNCTIONAL REQUIREMENTS

## 2.1 Performance

**NFR1:** Vote submission latency shall be < 300ms
- **Measurement:** Time from button click to database write completion
- **Components:** Frontend → API → Database → Response
- **Priority:** High
- **Rationale:** Judges need immediate feedback

**NFR2:** Real-time updates shall reach clients within 500ms of vote submission
- **Measurement:** Time from vote database write to audience display update
- **Components:** Database → Socket.IO emit → Client receive → UI update
- **Priority:** High
- **Rationale:** Maintain real-time feel for audience

**NFR3:** System shall support 100 concurrent audience viewers per competition
- **Load test:** Verify 100 Socket.IO connections to same room
- **Priority:** Medium
- **Rationale:** Typical local competition attendance

**NFR4:** Page load time shall be < 2 seconds on 4G connection
- **Measurement:** Time to First Contentful Paint (FCP)
- **Network:** 4G throttling in Chrome DevTools
- **Priority:** Medium
- **Rationale:** Judges often use mobile networks

---

## 2.2 Usability

**NFR5:** Judge interface shall be usable on smartphones with screen width ≥ 320px
- **Testing:** Verify on iPhone SE (320px width)
- **Priority:** High
- **Rationale:** Oldest common mobile device

**NFR6:** Vote buttons shall meet WCAG 2.1 touch target size guidelines
- **Minimum size:** 44x44px (WCAG Level AAA)
- **Recommended:** 80px+ height for JudgeMe
- **Priority:** High
- **Rationale:** Prevent mis-clicks during competitions

**NFR7:** System shall provide visual feedback within 100ms of button press
- **Feedback types:** Button color change, loading indicator, disabled state
- **Priority:** High
- **Rationale:** Perceived responsiveness

**NFR8:** URLs shall be shareable via any messaging platform
- **Platforms:** SMS, email, WhatsApp, Telegram, Slack
- **Constraint:** No special characters that break links
- **Priority:** High
- **Rationale:** Admins share links via various methods

---

## 2.3 Security

**NFR9:** Session IDs shall use cryptographically secure random generation
- **Method:** `crypto.randomBytes()` or UUID v4
- **Entropy:** Minimum 128 bits
- **Priority:** High
- **Rationale:** Prevent token guessing attacks

**NFR10:** URLs shall be immune to enumeration attacks
- **Verification:** Token space ≥ 2^128 (340 undecillion possibilities)
- **Rate limiting:** Max 10 invalid token attempts per IP per minute
- **Priority:** High

**NFR11:** System shall validate all input data
- **Validation:** Competition names, athlete names, weights, vote decisions
- **Sanitization:** Strip HTML/script tags to prevent XSS
- **Priority:** High

**NFR12:** System shall prevent XSS attacks via input sanitization
- **Method:** Escape HTML in user-provided strings
- **Libraries:** Use React's built-in XSS protection
- **Priority:** High

**NFR13:** System shall rate-limit vote submissions
- **Limit:** Maximum 1 vote per second per judge token
- **Response:** 429 Too Many Requests if exceeded
- **Priority:** Medium
- **Rationale:** Prevent vote spamming

---

## 2.4 Reliability

**NFR14:** WebSocket connections shall automatically reconnect on network interruption
- **Library:** Socket.IO built-in reconnection
- **Max retries:** Unlimited (with exponential backoff)
- **Priority:** High
- **Rationale:** Competitions often have unreliable WiFi

**NFR15:** System shall handle judge vote collisions gracefully
- **Strategy:** First write wins (database unique constraint)
- **Response:** Second vote attempt returns 409 Conflict
- **Priority:** High

**NFR16:** Database transactions shall ensure vote atomicity
- **Requirement:** Vote insert and count check must be atomic
- **Priority:** High
- **Rationale:** Prevent race conditions in result calculation

**NFR17:** System shall maintain data consistency across disconnections
- **Behavior:** On reconnect, fetch current state from server
- **No cached state:** Always trust server as source of truth
- **Priority:** High

---

## 2.5 Maintainability

**NFR18:** Codebase shall use TypeScript for type safety
- **Coverage:** 100% of backend and frontend code
- **Strict mode:** Enable `strict: true` in tsconfig.json
- **Priority:** High
- **Rationale:** Catch errors at compile time

**NFR19:** Database schema shall use migrations for version control
- **Tool:** Prisma Migrate
- **Requirement:** All schema changes must have migration files
- **Priority:** High
- **Rationale:** Track schema evolution, enable rollbacks

**NFR20:** Code shall follow established linting rules
- **Tool:** ESLint with TypeScript plugin
- **Enforcement:** CI/CD pipeline fails on lint errors
- **Priority:** Medium
- **Rationale:** Consistent code style

---

# 3. DATA REQUIREMENTS

## 3.1 Data Retention

**DR1:** Competition data shall be retained indefinitely
- **Rationale:** Historical dashboard requires past competitions
- **Storage:** SQLite file grows with data (no automatic deletion)

**DR2:** System shall support manual deletion of old competitions (future feature)
- **UI:** Admin dashboard with delete buttons
- **Cascade:** Delete all related athletes, lifts, and votes

## 3.2 Data Backup

**DR3:** SQLite database file should be backed up regularly (deployment-dependent)
- **Frequency:** Daily backups recommended for production
- **Method:** Simple file copy (SQLite is single file)

## 3.3 Data Privacy

**DR4:** No personally identifiable information (PII) collected beyond athlete names
- **Rationale:** GDPR compliance simplified
- **Note:** No emails, phone numbers, or accounts stored

---

# 4. INTERFACE REQUIREMENTS

## 4.1 User Interfaces

**UI1:** Homepage with competition creation form
- **Components:** Name input, athlete list, create button
- **Style:** Clean, minimal, mobile-friendly

**UI2:** Competition success page with shareable URLs
- **Components:** 5 URL cards with copy-to-clipboard buttons
- **Instruction text:** Clear labels for each role

**UI3:** Judge voting interface (mobile-optimized)
- **Components:** Lift info display, two large buttons
- **Layout:** Vertical stacking on mobile

**UI4:** Admin control panel (desktop-optimized)
- **Components:** Lift queue table, current lift panel, leaderboard
- **Layout:** Multi-column on large screens

**UI5:** Audience display (TV-optimized)
- **Components:** Large athlete name, 3 vote circles, result banner
- **Font sizes:** Readable from 30+ feet

**UI6:** Historical dashboard (desktop)
- **Components:** Competition list/table, filter options
- **Detail view:** Statistics and results

## 4.2 API Interfaces

See separate API documentation for detailed endpoint specifications.

**Key APIs:**
- `POST /api/competitions` - Create competition
- `GET /api/competitions/:id` - Get competition data
- `PATCH /api/competitions/:id/status` - Update competition status
- `POST /api/votes` - Submit judge vote
- `PATCH /api/lifts/:id/start` - Start lift
- `GET /api/stats/competitions` - List competitions
- `GET /api/stats/competitions/:id` - Get stats

## 4.3 Real-Time Interface (Socket.IO Events)

**Server → Client:**
- `flight_started` - Admin started new flight with group/discipline
  - Data: `{ flightId, groupName, flightName, discipline, athletes }`
- `lift_started` - New lift activated
  - Data: `{ liftId, athleteName, liftType, attempt, weight }`
- `vote_submitted` - Judge vote recorded (internal event, not shown to venue audience)
  - Data: `{ liftId, judgePosition, decision, timestamp }`
  - **Note:** Side referees and remote dashboard receive this; venue audience does NOT
- `lift_completed` - All 3 votes received, result calculated (public event)
  - Data: `{ liftId, result, votes: [{position, decision}, ...] }`
  - **Critical:** Venue audience receives all 3 votes simultaneously via this event
- `attempt_weight_updated` - Athlete Manager updated next attempt weight
  - Data: `{ athleteId, attemptNumber, newWeight }`
- `clock_started` - Head referee started 60-second countdown
  - Data: `{ liftId, startTime, duration: 60 }`
- `clock_tick` - Timer countdown update (emitted every second)
  - Data: `{ liftId, remainingSeconds }`
- `clock_reset` - Head referee reset timer
  - Data: `{ liftId }`
- `clock_expired` - Timer reached 0:00
  - Data: `{ liftId }`

**Client → Server:**
- `join_competition` - Subscribe to competition updates
  - Data: `{ competitionId }`
- `leave_competition` - Unsubscribe from updates
  - Data: `{ competitionId }`
- `start_clock` - Head referee starts timer (via API call, not direct socket)
- `reset_clock` - Head referee resets timer (via API call, not direct socket)

---

# 5. CONSTRAINTS

## 5.1 Technical Constraints

**TC1:** Must use SQLite for database (no PostgreSQL, MySQL, etc.)
- **Rationale:** Simplify deployment, eliminate database server

**TC2:** Must work in modern web browsers
- **Supported:** Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **Not supported:** IE11

**TC3:** Backend must be single Node.js process
- **Rationale:** Simplify deployment, reduce infrastructure costs

**TC4:** No authentication/login system (MVP scope)
- **Rationale:** Complexity reduction, faster development

## 5.2 Business Constraints

**BC1:** MVP must be completed in 2-4 weeks
- **Target:** Intermediate developer, full-time work

**BC2:** Must support local competitions (10-50 athletes typical)
- **Not required:** Large federation-scale competitions (100+ athletes)

## 5.3 Regulatory Constraints

**RC1:** Must comply with basic web security standards
- **OWASP Top 10:** Address common vulnerabilities

**RC2:** No specific powerlifting federation requirements
- **Note:** Generic judging system, not federation-specific

---

# 6. ASSUMPTIONS

**A1:** Judges have smartphones or tablets
**A2:** Venue has reliable internet connection (or admin provides hotspot)
**A3:** Admin knows athlete names before creating competition
**A4:** Three judges per competition (standard powerlifting format)
**A5:** No video replay needed (judges vote on live lifts)
**A6:** English language only for MVP

---

# 7. DEPENDENCIES

**D1:** Node.js runtime (v18+ recommended)
**D2:** Modern web browsers with JavaScript enabled
**D3:** WebSocket support (or Socket.IO fallback to long-polling)
**D4:** npm package ecosystem

---

# 8. ACCEPTANCE CRITERIA

## AC1: End-to-End Competition Flow

**Test scenario:**
1. Admin creates competition with 3 athletes
2. Admin shares judge links to 3 devices
3. Admin starts first lift
4. All 3 judges vote (2 white, 1 red)
5. Audience display shows votes and result
6. Admin completes all 27 lifts (3 athletes × 9 lifts)
7. Admin ends competition
8. Historical dashboard shows competition statistics

**Success:** All steps complete without errors, data accurate

## AC2: Real-Time Performance

**Test scenario:**
- Judge votes on lift
- Measure time until audience display updates

**Success:** Update appears within 500ms

## AC3: Mobile Usability

**Test scenario:**
- Judge opens link on iPhone SE (320px width)
- Interface displays correctly
- Vote buttons pressable without zoom

**Success:** Fully functional on small mobile screen

## AC4: Network Resilience

**Test scenario:**
- Judge disconnects WiFi mid-competition
- Judge reconnects WiFi
- Judge submits vote

**Success:** Vote records successfully after reconnection

---

# 9. OUT OF SCOPE (MVP)

The following features are explicitly **NOT** included in the MVP:

**OS1:** Multi-platform support (only 1 platform per competition)
**OS2:** Video replay for judges
**OS3:** Athlete accounts and self-service registration
**OS4:** Integration with federation databases (IPF, USAPL)
**OS5:** Hardware judge button integration
**OS6:** Live streaming integration
**OS7:** Native mobile apps (iOS/Android)
**OS8:** Multi-language support (internationalization)
**OS9:** Weight class and division filtering
**OS10:** Automatic lifting order calculation (simple lot number system only)
**OS11:** Rules display screen
**OS12:** Payment processing
**OS13:** Social media sharing
**OS14:** Email notifications

These features may be considered for v2.0 based on user feedback.

---

# 10. SUCCESS METRICS

## SM1: Development Velocity
- **Target:** MVP complete in 2-4 weeks
- **Measurement:** Track phase completion dates

## SM2: System Performance
- **Target:** Vote latency < 300ms (FR1)
- **Measurement:** Application Performance Monitoring (APM)

## SM3: Reliability
- **Target:** Zero data loss during competitions
- **Measurement:** Database consistency checks

## SM4: User Satisfaction (Post-Launch)
- **Target:** Admin can create competition in < 2 minutes
- **Measurement:** User testing, surveys

## SM5: Adoption (Post-Launch)
- **Target:** 10 competitions run in first month
- **Measurement:** Database competition count

---

# 11. CHANGE LOG

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2026-01-14 | AI Assistant | Initial draft for review |

---

# 12. APPROVAL

**Status:** Draft - Awaiting User Review

This requirements document should be reviewed and approved before beginning implementation.
